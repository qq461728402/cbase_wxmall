webpackJsonp([7],{"9a5Z":function(t,i,e){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=e("Dd8w"),s=e.n(o),n=e("uaSg"),c=e("8NGk"),r=e("NYxO"),a={render:function(){var t=this,i=t.$createElement,e=t._self._c||i;return e("div",{attrs:{id:"popup"}},[e("div",{staticClass:"yd-dialog-black-mask",model:{value:t.show,callback:function(i){t.show=i},expression:"show"}},[e("div",{staticClass:"yd-confirm"},[t._m(0),t._v(" "),e("div",{staticClass:"yd-confirm-bd"},[e("p",[t._v("\n                    确定"),e("span",{staticStyle:{color:"red"}},[t._v(t._s(t.item.price))]),t._v("元购买优惠券\n                ")]),t._v(" "),e("yd-cell-group",[e("yd-cell-item",[e("span",{attrs:{slot:"left"},slot:"left"},[t._v("推荐码：")]),t._v(" "),e("yd-input",{attrs:{slot:"right",placeholder:"请输入推荐码(可不填)"},slot:"right",model:{value:t.txcode,callback:function(i){t.txcode=i},expression:"txcode"}})],1)],1)],1),t._v(" "),e("div",{staticClass:"yd-confirm-ft"},[e("div",{staticClass:"yd-confirm-btn default",on:{click:t.cancel}},[t._v("取消")]),t._v(" "),e("div",{staticClass:"yd-confirm-btn primary",on:{click:t.confirm}},[t._v("确定")])])])])])},staticRenderFns:[function(){var t=this.$createElement,i=this._self._c||t;return i("div",{staticClass:"yd-confirm-hd"},[i("strong",{staticClass:"yd-confirm-title"},[this._v("温馨提示")])])}]};var l=e("VU/8")({data:function(){return{txcode:"",show:!1,item:""}},components:{},name:"couponPop",methods:{init:function(t){this.txcode="",this.item=t,this.show=!this.show},confirm:function(){this.$emit("confirmok",this.item,this.txcode),this.show=!this.show},cancel:function(){this.$emit("cancel"),this.show=!this.show}}},a,!1,function(t){e("ogiu")},null,null).exports,u={computed:s()({},Object(r.b)(["customerinfo"])),components:{couponpop:l},data:function(){return{isbuy:!1,page:1,pageSize:10,couponnum:{},couponslist:[],count:1,selettype:"CASH_COUPON",tablist:[{type:"CASH_COUPON",name:"现金券"}],bg:{background:"url("+e("LSyK")+")"}}},mounted:function(){this.page=1,this.couponlist(!1)},methods:{gotoback:function(){this.$router.go(-1)},switchlist:function(t,i){this.selettype=t,document.getElementById("scroll").scrollLeft=i.currentTarget.offsetLeft-10,this.page=1,this.couponlist(!1)},couponlist:function(t){var i={page:this.page,pageSize:this.pageSize};i.type=this.selettype;var e=this;Object(n.a)(this,"/api/coupon/list",i,"get",0==t&&1==this.page?"加载中...":"",function(t){e.count=2,1==e.page?t.coupons&&(e.couponslist=t.coupons,e.$refs.pullrefreshDemo.$emit("ydui.pullrefresh.finishLoad"),e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.reInit"),e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone")):t.coupons?(e.couponslist=e.couponslist.concat(t.coupons),t.coupons&&t.coupons.length!=this.pageSize?e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone"):e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.finishLoad")):e.$refs.infinitescrollDemo.$emit("ydui.infinitescroll.loadedDone")})},pullList:function(){this.page=1,this.couponlist(!0)},loadList:function(){this.page=this.page+1,this.couponlist(!0)},getCoupos:function(t){var i=this;this.isbuy=!0,this.$nextTick(function(){i.$refs.coupon.init(t)})},couponcancel:function(){this.isbuy=!1},couponbuy:function(t,i){var e=this;this.isbuy=!1,Object(n.a)(this,"/api/order/prePayCoupon",{confirmCode:i,coupon_id:t.id,customer_id:this.customerinfo.customerId},"get","正在购买",function(i){Object(c.c)(i.payInfo,function(i){"get_brand_wcpay_request:ok"==i.err_msg?(t.quantityAvailable=t.quantityAvailable-1,that.$dialog.alert({mes:"支付成功,请到我的优惠券查看"})):"get_brand_wcpay_request:cancel"==i.err_msg?that.$dialog.toast({mes:"支付取消",timeout:2e3}):"get_brand_wcpay_request:fail"==i.err_msg&&that.$dialog.toast({mes:"支付失败! 请重新支付",timeout:2e3})},function(t){e.$dialog.toast({mes:"支付取消",timeout:2e3})})})}}},d={render:function(){var t=this,i=t.$createElement,o=t._self._c||i;return o("yd-layout",{attrs:{id:"getcou"}},[o("yd-navbar",{attrs:{slot:"navbar",title:"优惠券",bgcolor:"#d41d0f",color:"#FFF"},slot:"navbar"},[o("router-link",{attrs:{slot:"left",to:""},nativeOn:{click:function(i){t.gotoback()}},slot:"left"},[o("yd-navbar-back-icon",{attrs:{color:"#FFF"}})],1)],1),t._v(" "),t.tablist.length>1?o("ul",{staticClass:"yd-scrollnav-tab-item",staticStyle:{color:"rgb(255, 0, 0)",height:"0.9rem"},attrs:{slot:"navbar",id:"scroll"},slot:"navbar"},t._l(t.tablist,function(i){return o("li",{class:{"yd-scrollnav-current":t.selettype==i.type},staticStyle:{color:"rgb(51, 51, 51)"},on:{click:function(e){t.switchlist(i.type,e)}}},[o("i"),o("span",[t._v(t._s(i.name))])])})):t._e(),t._v(" "),o("yd-pullrefresh",{ref:"pullrefreshDemo",attrs:{callback:t.pullList}},[o("yd-infinitescroll",{ref:"infinitescrollDemo",attrs:{callback:t.loadList}},[t._l(t.couponslist,function(i){return o("div",{staticStyle:{margin:"0.2rem"},attrs:{slot:"list"},slot:"list"},[o("yd-flexbox",{staticStyle:{"background-size":"100% 100%","border-radius":"0.15rem"},style:t.bg},[o("div",{staticStyle:{overflow:"hidden",padding:"0.15rem",height:"1.8rem",width:"1.8rem"}},[i.imgUrl?o("img",{staticStyle:{height:"1.5rem",width:"1.5rem"},attrs:{src:i.imgUrl}}):o("img",{staticStyle:{height:"1.5rem",width:"1.5rem",border:"1px solid #f2f2f2"},attrs:{src:e("S/uF")}})]),t._v(" "),o("yd-flexbox-item",{staticStyle:{height:"1.8rem"}},[o("yd-flexbox",{staticStyle:{"padding-top":"0.15rem"},attrs:{direction:"vertical"}},[o("yd-flexbox-item",[o("p",{staticStyle:{"font-size":"0.3rem","font-weight":"bold",height:"1rem"}},[t._v(t._s(i.name))])]),t._v(" "),o("yd-flexbox-item",[o("span",{staticStyle:{"font-size":"0.4rem",color:"#f00","padding-right":"0.2rem"}},[t._v(t._s(i.discount)),o("i",{staticStyle:{"font-size":"0.25rem"}},[t._v("现金劵")])]),o("span",{staticStyle:{color:"#f00","background-color":"#ffebdb",padding:"0.05rem","font-size":"0.25rem"}},[t._v(t._s(i.orderRequirement>0?"满"+i.orderRequirement+"可用":"无金额门槛"))])])],1)],1),t._v(" "),o("div",{attrs:{align:"center"}},[o("div",{staticStyle:{width:"1.6rem",height:"1.5rem",padding:"0.15rem"}},[o("yd-progressbar",{attrs:{progress:(i.quantity-i.quantityAvailable)/(i.quantity+0),"trail-width":"10","stroke-width":"10","stroke-color":"#ffb7b8","trail-color":"#f13130","fill-color":"#ffffff"}},[t._v("已抢\n                "),o("yd-countup",{attrs:{endnum:(i.quantity-i.quantityAvailable)/(i.quantity+0)*100,duration:.5,suffix:"%"}})],1)],1),t._v(" "),o("div",{staticStyle:{width:"1.6rem","text-align":"center","padding-bottom":".15rem"}},[o("yd-button",{staticStyle:{"font-size":".25rem",width:"1rem"},attrs:{type:"danger",bgcolor:"#f13130",color:"#ffffff"},nativeOn:{click:function(e){e.stopPropagation(),t.getCoupos(i)}}},[t._v(t._s(i.bonusPoints&&i.bonusPoints>0?i.bonusPoints+"积分":"立即购买"))])],1)])],1)],1)}),t._v(" "),o("span",{staticStyle:{display:"none"},attrs:{slot:"doneTip"},slot:"doneTip"},[t._v("我是有底线的")])],2)],1),t._v(" "),o("yd-backtop"),t._v(" "),0==t.couponslist.length&&1!=t.count?o("div",{staticClass:"noProduct"},[o("img",{attrs:{src:e("evVK")}}),t._v(" "),o("p",[t._v("没有优惠券领取")])]):t._e(),t._v(" "),t.isbuy?o("couponpop",{ref:"coupon",on:{confirmok:t.couponbuy,cancel:t.couponcancel}}):t._e()],1)},staticRenderFns:[]};var f=e("VU/8")(u,d,!1,function(t){e("ZHFr"),e("XUch")},"data-v-ce5e4710",null);i.default=f.exports},LSyK:function(t,i,e){t.exports=e.p+"static/img/bj.29822cc.jpg"},"S/uF":function(t,i,e){t.exports=e.p+"static/img/defuletCoupons1.2faee96.png"},XUch:function(t,i){},ZHFr:function(t,i){},evVK:function(t,i,e){t.exports=e.p+"static/img/myyhq.c20b577.png"},ogiu:function(t,i){}});