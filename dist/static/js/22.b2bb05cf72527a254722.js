webpackJsonp([22],{ML2d:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("uaSg"),o=i("NGEn"),a=i.n(o),r={data:function(){return{name:"",idNum:"",mobile:"",verifyCode:"",isregister:!0,start1:!1,isdeal:!0,selectCarNo:"1",cardno:"",carlist:[],openCardList:[],storeName:"",disabled:!1}},mounted:function(){this.$route.query.Code&&(this.disabled=!0,this.storeName=this.$route.query.stroeCode),this.storelist()},methods:{storelist:function(){var t=this;Object(s.a)(this,"/api/store/managerStoreList",{key:!1},"get","加载中...",function(e){e&&e.stores&&(t.openCardList=e.stores)})},sendCode1:function(){var t=this,e=this.$refs.idNum,i=this.$refs.mobile;0!=this.idNum.length&&0!=e.valid?0!=this.mobile.length&&0!=i.vaild?Object(s.a)(this,"/api/customer/sendSms",{method:this.isregister?"SendSmsCreate":"SendSmsBand",mobile:this.mobile,idNum:this.idNum,ppid:"0"},"post","发送中...",function(e){t.$dialog.toast({mes:"发送成功!",timeout:1e3,icon:"success"}),0==t.isregister&&(a()(e.msg)?t.carlist=e.msg:t.carlist=e.msg.split(","),t.carlist.length>0&&(t.cardno=t.carlist[0])),t.start1=!0}):this.$dialog.toast({mes:"请输入正确手机号",timeout:1e3}):this.$dialog.toast({mes:"请输入正确身份证号",timeout:1e3})},gotoreg:function(){0!=this.isdeal?this.isregister?this.registers():this.binds():this.$dialog.toast({mes:"请同意会员卡使用手册",timeout:1e3})},registers:function(){var t=this,e=this.$refs.idNum,i=this.$refs.mobile;0!=this.name.length?0!=this.idNum.length&&0!=e.valid?0!=this.mobile.length&&0!=i.vaild?0!=this.start1?0!=this.verifyCode.length?Object(s.a)(this,"/api/customer/register",{name:this.name,mobile:this.mobile,idNum:this.idNum,verifyCode:this.verifyCode,ppid:"0",publicid:"0",stroeId:this.storeName},"post","注册中...",function(e){e&&200==e.code&&t.$dialog.toast({mes:"注册成功!请绑定会员卡",timeout:1e3,icon:"success"})}):this.$dialog.toast({mes:"请输入验证码",timeout:1e3}):this.$dialog.toast({mes:"请获取验证码",timeout:1e3}):this.$dialog.toast({mes:"请输入正确手机号",timeout:1e3}):this.$dialog.toast({mes:"请输入正确身份证号",timeout:1e3}):this.$dialog.toast({mes:"请输入姓名",timeout:1e3})},binds:function(){var t=this,e=this.$refs.idNum,i=this.$refs.mobile;0!=this.idNum.length&&0!=e.valid?0!=this.mobile.length&&0!=i.vaild?0!=this.start1?0!=this.verifyCode.length?Object(s.a)(this,"/api/customer/bind",{mobile:this.mobile,idNum:this.idNum,verifyCode:this.verifyCode,cardno:this.cardno,ppid:"0",publicid:"0"},"post","绑定中...",function(e){e&&200==e.code&&t.$dialog.toast({mes:"绑定会员卡成功",timeout:1e3,icon:"success",callback:function(){t.gotoback()}})}):this.$dialog.toast({mes:"请输入验证码",timeout:1e3}):this.$dialog.toast({mes:"请获取验证码",timeout:1e3}):this.$dialog.toast({mes:"请输入正确手机号",timeout:1e3}):this.$dialog.toast({mes:"请输入正确身份证号",timeout:1e3})},gotoback:function(){this.$router.go(-1)},gotomanual:function(){this.$router.push({path:"/user/manual"})}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("yd-layout",{attrs:{id:"binding"}},[i("yd-navbar",{attrs:{slot:"navbar",title:"会员卡绑定",bgcolor:"#d41d0f",color:"#FFF"},slot:"navbar"}),t._v(" "),i("p",{staticClass:"car_title"},[t._v("重百新世纪")]),t._v(" "),i("yd-cell-group",{staticStyle:{margin:"0.2rem"},attrs:{title:t.isregister?"请输入您的信息,验证手机号,完成开卡。":"请输入会员卡信息完成绑定"}},[t.isregister?i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("姓名")]),t._v(" "),i("yd-input",{attrs:{slot:"right",placeholder:"请输入姓名"},slot:"right",model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1):t._e(),t._v(" "),i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("身份证")]),t._v(" "),i("yd-input",{ref:"idNum",attrs:{slot:"right",regex:"(^\\d{15}$)|(^\\d{17}([0-9]|X)$)",placeholder:"请输入身份证"},slot:"right",model:{value:t.idNum,callback:function(e){t.idNum=e},expression:"idNum"}})],1),t._v(" "),i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("手机号")]),t._v(" "),i("yd-input",{ref:"mobile",attrs:{slot:"right",type:"number",placeholder:"请输入手机号码"},slot:"right",model:{value:t.mobile,callback:function(e){t.mobile=e},expression:"mobile"}}),t._v(" "),i("yd-sendcode",{attrs:{slot:"right",type:"warning"},nativeOn:{click:function(e){t.sendCode1(e)}},slot:"right",model:{value:t.start1,callback:function(e){t.start1=e},expression:"start1"}})],1),t._v(" "),i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("验证码")]),t._v(" "),i("yd-input",{attrs:{slot:"right",type:"number",placeholder:"请输入验证码"},slot:"right",model:{value:t.verifyCode,callback:function(e){t.verifyCode=e},expression:"verifyCode"}})],1),t._v(" "),t.isregister?t._e():i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("选择卡号")]),t._v(" "),t.carlist.length>0?i("div",{staticStyle:{width:"100%","text-align":"left"},attrs:{slot:"right",id:"carNO"},slot:"right"},[i("yd-radio-group",{model:{value:t.cardno,callback:function(e){t.cardno=e},expression:"cardno"}},t._l(t.carlist,function(t){return i("p",[i("yd-radio",{attrs:{val:t}})],1)}))],1):t._e()]),t._v(" "),t.isregister?i("yd-cell-item",[i("span",{attrs:{slot:"left"},slot:"left"},[t._v("开卡门店")]),t._v(" "),0==t.disabled?i("select",{directives:[{name:"model",rawName:"v-model",value:t.storeName,expression:"storeName"}],attrs:{slot:"right"},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.storeName=e.target.multiple?i:i[0]}},slot:"right"},[i("option",{attrs:{value:""}},[t._v("请选择开卡门店(选填)")]),t._v(" "),t._l(t.openCardList,function(e,s){return i("option",{key:s,domProps:{value:e.externalId}},[t._v(t._s(e.storeName))])})],2):i("select",{directives:[{name:"model",rawName:"v-model",value:t.storeName,expression:"storeName"}],attrs:{slot:"right",disabled:""},on:{change:function(e){var i=Array.prototype.filter.call(e.target.options,function(t){return t.selected}).map(function(t){return"_value"in t?t._value:t.value});t.storeName=e.target.multiple?i:i[0]}},slot:"right"},[i("option",{attrs:{value:""}},[t._v("请选择开卡门店(选填)")]),t._v(" "),t._l(t.openCardList,function(e,s){return i("option",{key:s,domProps:{value:e.externalId}},[t._v(t._s(e.storeName))])})],2)]):t._e()],1),t._v(" "),i("div",{staticClass:"login_2"},[i("yd-checkbox",{attrs:{color:"#F00",size:"16"},model:{value:t.isdeal,callback:function(e){t.isdeal=e},expression:"isdeal"}},[i("span",{staticStyle:{"line-height":"16px","font-size":"0.28rem"}},[t._v("同意")])]),i("span",{staticStyle:{color:"#d41d0f","font-size":"14px"},on:{click:t.gotomanual}},[t._v("《重百新世纪会员卡使用手册》")])],1),t._v(" "),i("div",{staticStyle:{"text-align":"center","margin-top":"0.6rem"}},[i("yd-button",{staticStyle:{"background-color":"#f44",width:"80%",height:"1rem","font-size":".3rem"},nativeOn:{click:function(e){t.gotoreg(e)}}},[t._v(t._s(t.isregister?"新会员注册":"会员卡绑定"))])],1),t._v(" "),i("div",{staticClass:"login_2",staticStyle:{"text-align":"center"}},[i("label",{staticClass:"login_3"},[i("a",{staticClass:"login_4",on:{click:function(e){t.isregister=!t.isregister}}},[t._v(t._s(1==t.isregister?"已有会员卡去绑定":"新会员注册"))]),i("br")])])],1)},staticRenderFns:[]};var n=i("VU/8")(r,l,!1,function(t){i("dKqN"),i("mPRz")},"data-v-8fd6f71a",null);e.default=n.exports},NGEn:function(t,e){var i=Array.isArray;t.exports=i},dKqN:function(t,e){},mPRz:function(t,e){}});